<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Natasha Luzhkova Digital Library AI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif; 
      background-image: url("https://static.vecteezy.com/system/resources/previews/014/799/243/non_2x/abstract-green-gradient-mountain-background-design-for-wallpaper-backdrop-pattern-texture-background-textile-wrapping-clothing-art-print-illustration-modern-retro-vintage-style-free-vector.jpg");
      background-repeat: no-repeat;
      background-size: cover;
    }
    .loader { border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
    @keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }
  </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

  <div class="w-full max-w-3xl mx-auto p-4 sm:p-6 md:p-8">
    <div class="bg-white rounded-2xl shadow-xl p-6 sm:p-8">
      <div class="text-center mb-8">
        <h1 class="text-3xl sm:text-4l font-bold text-gray-800">Natasha Luzhkova Digital Library AI Tool</h1>
        <a class="text-blue-600 00 mt-2 underline" href="https://worldtrailsnetwork.org/in-memoriam-natasha-luzhkova/">Built in loving memory of Natasha Luzhkova</a>

        <div class="border rounded-lg mb-4 mt-4">
          <button class="accordion-toggle w-full flex justify-between items-center px-4 py-2 text-left font-semibold text-gray-600 hover:bg-green-200">
            <span>Welcome to the NL Digital Library AI Tool!</span>
            <svg class="accordion-icon w-5 h-5 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
          </button>
          <div class="accordion-content hidden px-4 py-3">
            <p class="text-gray-600 text-sm">This tool was built to help improve accessibility to global trail information. To use it, simply enter your question or topic of interest—such as trail sustainability, community engagement, accessibility, or recreation management—and the system will search its curated collection of resources to provide clear, evidence-based answers. It connects you with relevant research, case studies, and best practices from both the <a text-blue-600 underline href="https://mountainsteward.net/toolbox/wiki/index.php/Main_Page"> NL-Digital Library </a> and the external internet, making it easier to design, manage, or study trails with both ecological and social considerations in mind. To add a source to the NL-Digital Library, please see the link to the google form at the bottom of the page. Thank you! </p>
          </div>
        </div>

      <!-- Input Form -->
      <div class="relative">
        <input type="text" id="user-query" placeholder="Ask a question..." class="w-full pl-4 pr-12 py-3 bg-gray-50 border-gray-300 rounded-full focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none" required>
        <button id="submit-button" class="absolute inset-y-0 right-0 flex items-center justify-center w-12 h-full text-white bg-green-600 hover:bg-green-700 rounded-full">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M12 5l7 7-7 7" /></svg>
        </button>
      </div>

      <!-- Loader -->
      <div id="loader" class="hidden flex justify-center items-center mt-8 mb-8">
        <div class="loader"></div>
        <p class="ml-4 text-gray-600">Searching...</p>
      </div>

      <!-- Responses Container -->
      <div id="response-container" class="hidden space-y-4">

        <!-- NLDL Accordion -->
        <div class="border rounded-lg text-left mt-3 mb-3">
          <button class="accordion-toggle w-full flex justify-between items-center px-4 py-2 text-left font-semibold text-gray-800 bg-green-100 hover:bg-green-200">
            <span>Response from NLDL sources</span>
            <svg class="accordion-icon w-5 h-5 transform transition-transform rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
          </button>
          <div class="accordion-content px-4 py-3">
            <div id="NLDL-response" class="prose max-w-none prose-a:text-blue-600 text-gray-700"></div>
          </div>
        </div>

        <!-- Web Accordion -->
        <div class="border rounded-lg text-left mt-3 mb-3">
          <button class="accordion-toggle w-full flex justify-between items-center px-4 py-2 text-left font-semibold text-gray-800 bg-blue-100 hover:bg-blue-200">
            <span>Response from sources on the web</span>
            <svg class="accordion-icon w-5 h-5 transform transition-transform rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" /></svg>
          </button>
          <div class="accordion-content px-4 py-3">
            <div id="web-response" class="prose max-w-none prose-a:text-blue-600 text-gray-700"></div>
          </div>
        </div>
      </div>

      <!-- Sources Link -->
       <div class="text-center mt-3">
        <a class="text-blue-600 mt-2 underline;" href="https://forms.gle/Mku7Zv3JgMvQGVRy7" target="_blank" rel="noopener noreferrer">Found a source online which seems useful? Add it here!</a>
       </div>
    </div>
  </div>

<script>
const queryForm = document.getElementById('query-form');
const userQueryInput = document.getElementById('user-query');
const responseContainer = document.getElementById('response-container');
const loader = document.getElementById('loader');

const NLDLResponse = document.getElementById('NLDL-response');
const sttSources = document.getElementById('NLDL-sources');
const sttSourcesList = document.getElementById('NLDL-sources-list');

const webResponse = document.getElementById('web-response');
const webSources = document.getElementById('web-sources');
const webSourcesList = document.getElementById('web-sources-list');

// Accordion toggle
function setupAccordions() {
  document.querySelectorAll('.accordion-toggle').forEach(toggle => {
    toggle.addEventListener('click', () => {
      const content = toggle.nextElementSibling;
      const icon = toggle.querySelector('.accordion-icon');
      content.classList.toggle('hidden');
      icon.classList.toggle('rotate-180');
    });
  });
}
setupAccordions();

{% if response %}
loader.classList.add('hidden');
responseContainer.classList.remove('hidden');
NLDLResponse.innerHTML = marked.parse(`{{NLDL_response_content}}`);
webResponse.innerHTML = marked.parse(`{{web_response_content}}`);
{% else %}
responseContainer.classList.add('hidden');
{% endif %}

// Handle query
document.getElementById("submit-button").addEventListener('click', async e => {
  var query = document.getElementById("user-query").value;
  var thisLocation = window.location.toString();
  loader.classList.remove('hidden');
  window.location.replace(thisLocation.replace(/\/[^/]*$/, `/${query}`));
});
</script>
</body>
</html>
